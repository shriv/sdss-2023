
# Walkability {#sec-walkability}

This analysis considers _local walkability_ by calculating travel times to the closest public playground. Playgrounds are a useful candidate to assess the potential of walking to a nearby amenity as they are distributed evenly through the city with an average catchment of 600m (@fig-wcc-playgrounds).  

![Locations of council playgrounds designed with a 600m catchment.](assets/wcc-playgrounds.png){width=80%, #fig-wcc-playgrounds}

## Distance and speed on hilly terrain
Distance-based planning is convenient as it's easy to calculate and objective. However, it doesn't translate well to people's decision making which are typically time-centric as well as accounting for some or all of the 5Cs of walkability @londonplanningadvisorycommitteePuttingLondonBack1997. Hence, even simple distance to time conversions can be more informative to the layperson planning a walking trip to the park. @fig-map-dist-time shows a conversion from distance to time assuming a speed of 5km/h - a common conversion based on a fit adult e.g. [Section 3.4 in NZTA pedestrian planning and design guide](https://www.nzta.govt.nz/assets/resources/pedestrian-planning-guide/docs/pedestrian-planning-guide.pdf).  


![Walkability maps coloured as both distance (m) and time (minutes).](assets/flat-walkability-dist-time-map.png){#fig-map-dist-time}

As expected, the histograms of distance and time with a linear conversion look the same with the time variant being more useful for comparison with an upcoming trip - much like typical Google map direction checks. 

![](assets/flat-walkability-dist-time-histogram.png){#fig-hist-dist-time}


## Accounting for hills

This analysis makes use of Tobler's function for calculating speed given a hill gradient. While this approach is rather old, it is still the best option when real world data is not available for re-parametrisation. Toblerâ€™s hiking function for speed,
$\nu$, is a shifted exponential with three parameters $a$, $b$ and $c$ which give the fastest speed, speed retardation due to gradient and shift from zero respectively.


$$
\nu = a \exp^{(-b|slope + c|)}
$$

Note that $slope$ in the equation is a dimensionless quantity: $\frac{dh}{dx}$  (or, rise / run). Terminology-wise, 
$slope$, is equivalent to gradient and inclination. Speed is given in in km/h and can be converted to a travel time in minutes with a multiplicative factor, (60/1000). 

@fig-toblers-params shows two versions of the same functional form i.e. with different co-efficients. Brunsdon's form has parameters fitted with Strava data @RPubsTobler39. A future version of this analysis would be best done with a similar approach of re-parametrising Tobler's function with real-world data. However, data from fitness apps like Strava should be used carefully as they are strongly biased and don't capture the variation of citizens of different ages and capabilities.


![Tobler's function parameters from original paper @toblerThreePresentationsGeographical1993 and Chris Brunsdon's form with parameters fitted with Strava data @RPubsTobler39.](assets/toblers-params.png){#fig-toblers-params}


@fig-toblers-fn shows how speed by hill gradient converts to travel time by hill gradient. Flat curves for 3km/h and 5km/h are shown for reference. Both Tobler's and Brundon's curves are skewed - with the highest speeds for negative gradients (i.e. while walking downhill). Tobler's parameters correspond to a 5km/h speed at zero gradient. 

![Visualisation of Tobler's functional form as time and speed using parameters from original paper and Chris Brunsdon's form with parameters fitted with Strava data](assets/toblers-fn.png){#fig-toblers-fn}

## Differences due to hills

Tobler's function indicates that slopes can increase travel times considerably. Heatmaps like @fig-map-dist-time are useful for a holistic picture but lack connection to the average citizen's day to day life. Instead, the complexity from the walking time distribution is simplified with a Bayesian model of average walking times and spread in walking times by suburb. This connects citizens better to their expected walking times as well as how suitable their neighbourhoods are for walking. 


![Forest plot showing average ($\mu$) and spread ($\sigma$) in walking time to the nearest playground.](assets/modelling-suburbs.png){#fig-forest-plot}


The forest plot can be summarised with a quadrant classification. 


|                      | High $\mu_{norm}$ | Low $\mu_{norm}$ |
| :------------------: | :------------: | :-----------: |
| Low $\sigma_{norm}$  | Consistently good walkability  |  Consistent but poor walkability |
| High $\sigma_{norm}$  | Poor walkability for most areas |  Good walkability for some areas |


We can get the suburbs that lie in the 4 quadrants listed above with some simple data filters. The list goes from the best suburbs to the worst in terms of consistent walkability to playgrounds.


| suburb | quadrant  |characteristic |
|--- |--- |--- |
|Te Aro|Low $\sigma$ and $\mu$| Consistently good walkability|
|Newtown|Low $\sigma$ and $\mu$| Consistently good walkability |
|Pipitea|Low $\sigma$; High $\mu$| Consistent but poor walkability |
|Hataitai|Low $\sigma$; High $\mu$|Consistent but poor walkability|
|Newlands|High $\sigma$; Low $\mu$|Good walkability for some areas |
|Tawa|High $\sigma$; Low $\mu$| Good walkability for some areas |
|Brooklyn|High $\sigma$; Low $\mu$| Good walkability for some areas |
|Khandallah|High $\sigma$ and $\mu$| Poor walkability for most areas|
|Karori|High $\sigma$ and $\mu$| Poor walkability for most areas|


